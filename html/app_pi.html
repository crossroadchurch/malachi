<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Malachi App</title>
    <link rel="stylesheet" href="/html/libs/toastify.css" />
    <link rel="stylesheet" href="/html/app.css" />
    <link rel="shortcut icon" href="/html/favicon.png" type="image/png" />
    <script type="text/javascript" src="/html/libs/toastify.min.js"></script>
    <script type="text/javascript" src="/html/app.js"></script>
  </head>
  <body>
    <div id="main_area">
      <div id="item_area">
        <div id="screen_view">
          <iframe id="screen_iframe" src="./screen_pi?muted=true&videos=false"></iframe>
        </div>
        <div id="item_header">
          <div class="mi_toggle">
            <input type="checkbox" id="flip_screen_state" name="flip_screen_state" />
            <output id="flip_screen_state_out"></output>
          </div>
          <img id="current_item_icon" src="/html/icons/icons8-musical-notes-48.png" /><span
            id="current_item_name"
            >No current item</span
          >
        </div>
        <div id="current_item">
          <div id="audio_controls">
            <div class="playback_buttons">
              <div class="button_inline_text">Song recording:</div>
              <div class="cmd_button icon_button play_icon" onclick="play_audio()"></div>
              <div class="cmd_button icon_button pause_icon" onclick="pause_audio()"></div>
              <div class="cmd_button icon_button stop_icon" onclick="stop_audio()"></div>
            </div>
          </div>
          <div id="video_controls">
            <div class="playback_buttons">
              <div class="cmd_button icon_button play_icon" onclick="play_video()"></div>
              <div class="cmd_button icon_button pause_icon" onclick="pause_video()"></div>
              <div class="cmd_button icon_button stop_icon" onclick="stop_video()"></div>
              <div class="cmd_button menu_button restore_button" onclick="restore_loop()">
                Restore loop
              </div>
            </div>
            <div id="time_seek_area">
              <progress id="time_seek" min="0" max="100"></progress>
            </div>
          </div>
          <div id="presentation_controls">
            <div class="playback_buttons">
              <div class="cmd_button icon_button play_icon" onclick="start_presentation()"></div>
              <div class="cmd_button menu_button restore_button" onclick="restore_loop()">
                Restore loop
              </div>
            </div>
          </div>
          <div id="bible_controls">
            <div id="b_main_version_radios" class="radio_toggle_group"></div>
            <div id="b_alt_version_radios" class="radio_toggle_group"></div>
          </div>
          <div id="current_item_list_div">
            <div id="current_item_list" class="ml_list"></div>
          </div>
        </div>
      </div>
      <div id="elements_area" ondragover="drag_over(event)" ondrop="drag_drop(event)">
        <div id="elements_header">
          <div
            id="service_elt_button"
            class="element_button active_element"
            onclick="load_element('service')"
          >
            <img class="element_icon" src="/html/icons/icons8-numbered-list-48.png" />
          </div>
          <div id="song_elt_button" class="element_button" onclick="load_element('song')">
            <img class="element_icon" src="/html/icons/icons8-musical-notes-48.png" />
          </div>
          <div id="bible_elt_button" class="element_button" onclick="load_element('bible')">
            <img class="element_icon" src="/html/icons/icons8-literature-48.png" />
          </div>
          <div
            id="presentation_elt_button"
            class="element_button"
            onclick="load_element('presentation')"
          >
            <img class="element_icon" src="/html/icons/icons8-presentation-48.png" />
          </div>
          <div id="video_elt_button" class="element_button" onclick="load_element('video')">
            <img class="element_icon" src="/html/icons/icons8-tv-show-48.png" />
          </div>
          <div
            id="backgrounds_elt_button"
            class="element_button"
            onclick="load_element('backgrounds')"
          >
            <img class="element_icon" src="/html/icons/icons8-image-48.png" />
          </div>
          <div id="styles_elt_button" class="element_button" onclick="load_element('styles')">
            <img class="element_icon" src="/html/icons/icons8-services-48.png" />
          </div>
          <div id="updater_elt_button" class="element_button" onclick="load_element('updater')">
            <img class="element_icon" src="/html/icons/icons8-alert-48.png" />
          </div>
          <div
            id="help_button"
            class="element_button"
            onclick="window.open('https://github.com/crossroadchurch/malachi/wiki/User-Guide#wiki-wrapper', '_blank', 'status=0')"
          >
            <img class="element_icon" src="/html/icons/icons8-help-48.png" />
          </div>
        </div>

        <div id="service_element" class="element_panel">
          <div id="service_menu">
            <div class="cmd_button menu_button" onclick="new_service(false)">New</div>
            <div class="cmd_button menu_button" onclick="load_service_preload()">Load</div>
            <div class="cmd_button menu_button" onclick="save_service('none')">Save</div>
            <div class="cmd_button menu_button" onclick="open_save_service_popup()">Save as</div>
            <div class="cmd_button menu_button" onclick="open_export_service_popup()">Export</div>
          </div>
          <h3>Service plan</h3>
          <div id="service_list" class="ml_list"></div>
          <div id="countdown_control">
            <div class="cmd_button small_button" onclick="start_countdown()">
              Start countdown to:
            </div>
            <input type="time" id="cd_time" name="cd_time" class="mi_textinput" />
            <div class="cmd_button small_button" onclick="clear_countdown()">Cancel countdown</div>
          </div>
        </div>

        <div id="song_element" class="element_panel">
          <div class="refresh_header">
            <h3>Songs</h3>
            <div id="create_song_btn" class="cmd_button" onclick="create_song()">
              <img src="/html/icons/icons8-plus-24.png" />
              <span>Create song</span>
            </div>
          </div>
          <div class="search_div">
            <input
              type="search"
              id="song_search"
              value=""
              class="mi_textinput"
              placeholder="Lyric or title search"
            />
            <div class="cmd_button small_button" onclick="song_search()">
              <img src="/html/icons/icons8-search-24.png" />
              <span>Search</span>
            </div>
            <div class="radio_toggle_group">
              <input type="radio" name="lr_search" id="lr_search_0" data-lrs="0" />
              <label for="lr_search_0">Local</label>
              <input type="radio" name="lr_search" id="lr_search_1" data-lrs="1" />
              <label for="lr_search_1">Remote</label>
            </div>
          </div>
          <div id="song_list" class="ml_list"></div>
        </div>

        <div id="bible_element" class="element_panel">
          <div class="refresh_header">
            <h3>Bible</h3>
            <div id="b_version_radios" class="radio_toggle_group"></div>
          </div>
          <div class="search_div">
            <input type="search" id="bible_search" value="" class="mi_textinput" />
            <div class="cmd_button small_button" onclick="bible_search()">
              <img src="/html/icons/icons8-search-24.png" />
              <span>Search</span>
            </div>
          </div>

          <div id="bible_search_options">
            <span>Search by:</span>
            <div class="radio_toggle_group">
              <input
                type="radio"
                name="b_search_type"
                id="b_search_type_ref"
                value="on"
                checked="checked"
              />
              <label for="b_search_type_ref">Ref</label>
              <input type="radio" name="b_search_type" id="b_search_type_text" value="off" />
              <label for="b_search_type_text">Text</label>
            </div>
            <div class="cmd_button small_button" onclick="select_all_verses()">Select all</div>
            <div class="cmd_button small_button" onclick="select_none_verses()">Select none</div>
            <div class="cmd_button small_button" onclick="add_verses()">
              <img src="/html/icons/icons8-plus-24.png" />
              <span>Add to service</span>
            </div>
          </div>
          <div id="passage_list" class="ml_list"></div>
        </div>

        <div id="presentation_element" class="element_panel">
          <div class="refresh_header">
            <h3>Presentations</h3>
            <div
              class="cmd_button icon_button refresh_icon"
              onclick="refresh_presentations()"
            ></div>
          </div>
          <div id="presentation_list" class="ml_list"></div>
        </div>

        <div id="video_element" class="element_panel">
          <div class="refresh_header">
            <h3>Videos</h3>
            <div class="cmd_button icon_button refresh_icon" onclick="refresh_videos()"></div>
          </div>
          <div id="video_list" class="ml_list"></div>
        </div>

        <div id="backgrounds_element" class="element_panel">
          <div class="refresh_header">
            <h3>Loops</h3>
            <div class="cmd_button icon_button refresh_icon" onclick="refresh_loops()"></div>
          </div>
          <div id="loop_list" class="ml_list"></div>
          <div class="cmd_button full_button" onclick="clear_loop()">Clear loop</div>
          <div class="refresh_header">
            <h3>Backgrounds</h3>
            <div class="cmd_button icon_button refresh_icon" onclick="refresh_backgrounds();"></div>
          </div>
          <div class="song_bible_area">
            <div class="ml_list song_bible_button">
              <div class="ml_row">
                <div class="ml_text">Songs</div>
                <img id="song_bg_icon" src="" />
                <a class="ml_button ml_icon ml_icon_minus" onclick="remove_song_background();"></a>
              </div>
            </div>
            <div class="ml_list song_bible_button">
              <div class="ml_row">
                <div class="ml_text">Bible</div>
                <img id="bible_bg_icon" src="" />
                <a class="ml_button ml_icon ml_icon_minus" onclick="remove_bible_background();"></a>
              </div>
            </div>
          </div>
          <div id="background_list" class="ml_list"></div>
        </div>

        <div id="styles_element" class="element_panel">
          <h3>Settings</h3>
          <div id="sh_mainarea" class="ml_row style_header">
            <div class="sl_text">Main area</div>
            <a class="sl_button ml_icon ml_icon_dots" onclick="expand_section('mainarea')"></a>
          </div>
          <div id="sg_mainarea" class="style_group">
            <div class="mi_range">
              <label for="s_width">Song area width (% of screen):</label>
              <input
                id="s_width"
                type="range"
                min="50"
                max="100"
                step="1"
                oninput="style_slider_input(this)"
                onchange="style_slider_change(this)"
              />
              <output id="s_width_out"></output>
            </div>
            <div class="mi_range">
              <label for="s_font_size">Font size (% of screen height):</label>
              <input
                id="s_font_size"
                type="range"
                min="5"
                max="20"
                step="1"
                oninput="style_slider_input(this)"
                onchange="style_slider_change(this)"
              />
              <output id="s_font_size_out"></output>
            </div>
            <div class="mi_range">
              <label for="s_lines">Max lines per slide:</label>
              <input
                id="s_lines"
                type="range"
                min="1"
                max="10"
                step="1"
                oninput="style_slider_input(this)"
                onchange="style_slider_change(this)"
              />
              <output id="s_lines_out"></output>
            </div>
            <div class="mi_range">
              <label for="s_margin">Top margin (% of screen height):</label>
              <input
                id="s_margin"
                type="range"
                min="0"
                max="25"
                step="1"
                oninput="style_slider_input(this)"
                onchange="style_slider_change(this)"
              />
              <output id="s_margin_out"></output>
            </div>
            <span>Song and Bible text colour:</span>
            <div id="rgb_container">
              <div id="rgb_sliders">
                <div class="mi_range mi_range_compact">
                  <span style="color: red"><strong>R</strong></span>
                  <input
                    id="tc_red"
                    type="range"
                    min="0"
                    max="255"
                    step="1"
                    oninput="style_slider_input(this)"
                    onchange="color_slider_change(this)"
                  />
                  <output id="tc_red_out"></output>
                </div>
                <div class="mi_range mi_range_compact">
                  <span style="color: green"><strong>G</strong></span>
                  <input
                    id="tc_green"
                    type="range"
                    min="0"
                    max="255"
                    step="1"
                    oninput="style_slider_input(this)"
                    onchange="color_slider_change(this)"
                  />
                  <output id="tc_green_out"></output>
                </div>
                <div class="mi_range mi_range_compact">
                  <span style="color: blue"><strong>B</strong></span>
                  <input
                    id="tc_blue"
                    type="range"
                    min="0"
                    max="255"
                    step="1"
                    oninput="style_slider_input(this)"
                    onchange="color_slider_change(this)"
                  />
                  <output id="tc_blue_out"></output>
                </div>
              </div>
              <div id="rgb_preview_panel">
                <div id="tc_preview"></div>
                <div id="tc_save" class="cmd_button small_button" onclick="save_color_sliders()">
                  Save colour
                </div>
              </div>
            </div>
            <div id="o_style_div" class="radio_toggle_group">
              <span>Text outline:</span>
              <input type="radio" name="o_style" id="o_style_1" data-ol="drop-shadow" />
              <label for="o_style_1">Drop shadow</label>
              <input type="radio" name="o_style" id="o_style_2" data-ol="text-outline" />
              <label for="o_style_2">Outlined</label>
              <input type="radio" name="o_style" id="o_style_3" data-ol="none" />
              <label for="o_style_3">None</label>
            </div>
          </div>
          <div id="sh_bible" class="ml_row style_header">
            <div class="sl_text">Bible passages</div>
            <a class="sl_button ml_icon ml_icon_dots" onclick="expand_section('bible')"></a>
          </div>
          <div id="sg_bible" class="style_group">
            <div id="d_version_radios" class="radio_toggle_group">
              <span>Default Bible version:</span>
            </div>
            <div class="mi_range">
              <label for="pl_width">Parallel column width (% of screen):</label>
              <input
                id="pl_width"
                type="range"
                min="30"
                max="50"
                step="1"
                oninput="style_slider_input(this)"
                onchange="style_slider_change(this)"
              />
              <output id="pl_width_out"></output>
            </div>
            <div class="mi_range">
              <label for="pl_font_size">Parallel font size (% of screen height):</label>
              <input
                id="pl_font_size"
                type="range"
                min="5"
                max="20"
                step="1"
                oninput="style_slider_input(this)"
                onchange="style_slider_change(this)"
              />
              <output id="pl_font_size_out"></output>
            </div>
            <div class="mi_range">
              <label for="pl_lines">Parallel max lines per slide:</label>
              <input
                id="pl_lines"
                type="range"
                min="1"
                max="10"
                step="1"
                oninput="style_slider_input(this)"
                onchange="style_slider_change(this)"
              />
              <output id="pl_lines_out"></output>
            </div>
          </div>
          <div id="sh_countdowns" class="ml_row style_header">
            <div class="sl_text">Countdowns</div>
            <a class="sl_button ml_icon ml_icon_dots" onclick="expand_section('countdowns')"></a>
          </div>
          <div id="sg_countdowns" class="style_group">
            <div class="mi_range">
              <label for="ch_size">Header font size (% of screen height):</label>
              <input
                id="ch_size"
                type="range"
                min="1"
                max="50"
                step="1"
                oninput="style_slider_input(this)"
                onchange="style_slider_change(this)"
              />
              <output id="ch_size_out"></output>
            </div>
            <div id="countdown_h_text_input">
              <label for="cd_text">Header text:</label>
              <input type="text" id="cd_text" class="mi_textinput" />
            </div>
            <div class="mi_range">
              <label for="cd_size">Countdown font size (% of screen height):</label>
              <input
                id="cd_size"
                type="range"
                min="1"
                max="50"
                step="1"
                oninput="style_slider_input(this)"
                onchange="style_slider_change(this)"
              />
              <output id="cd_size_out"></output>
            </div>
            <div class="mi_range">
              <label for="cd_top">Countdown top margin (% of screen height):</label>
              <input
                id="cd_top"
                type="range"
                min="0"
                max="100"
                step="1"
                oninput="style_slider_input(this)"
                onchange="style_slider_change(this)"
              />
              <output id="cd_top_out"></output>
            </div>
          </div>
          <div id="sh_copyright" class="ml_row style_header">
            <div class="sl_text">Copyright area</div>
            <a class="sl_button ml_icon ml_icon_dots" onclick="expand_section('copyright')"></a>
          </div>
          <div id="sg_copyright" class="style_group">
            <div class="mi_toggle_div">
              <span>Display copyright:</span>
              <div class="mi_toggle">
                <input type="checkbox" id="d_copyright" />
                <output id="d_copyright_out"></output>
              </div>
            </div>
            <div class="mi_range">
              <label for="cp_size">Copyright font size (0.1% of screen height):</label>
              <input
                id="cp_size"
                type="range"
                min="10"
                max="50"
                step="1"
                oninput="style_slider_input(this)"
                onchange="style_slider_change(this)"
              />
              <output id="cp_size_out"></output>
            </div>
            <div class="mi_range">
              <label for="cp_width">Copyright area width (% of screen width):</label>
              <input
                id="cp_width"
                type="range"
                min="20"
                max="90"
                step="1"
                oninput="style_slider_input(this)"
                onchange="style_slider_change(this)"
              />
              <output id="cp_width_out"></output>
            </div>
          </div>
          <div id="sh_verseorder" class="ml_row style_header">
            <div class="sl_text">Verse order area</div>
            <a class="sl_button ml_icon ml_icon_dots" onclick="expand_section('verseorder')"></a>
          </div>
          <div id="sg_verseorder" class="style_group">
            <div class="mi_toggle_div">
              <span>Display verse order:</span>
              <div class="mi_toggle">
                <input type="checkbox" id="d_verseorder" />
                <output id="d_verseorder_out"></output>
              </div>
            </div>
            <div class="mi_range">
              <label for="vo_size">Verse order font size (0.1% of screen height):</label>
              <input
                id="vo_size"
                type="range"
                min="10"
                max="50"
                step="1"
                oninput="style_slider_input(this)"
                onchange="style_slider_change(this)"
              />
              <output id="vo_size_out"></output>
            </div>
            <div class="mi_range">
              <label for="vo_width">Verse order area width (% of screen width):</label>
              <input
                id="vo_width"
                type="range"
                min="20"
                max="90"
                step="1"
                oninput="style_slider_input(this)"
                onchange="style_slider_change(this)"
              />
              <output id="vo_width_out"></output>
            </div>
          </div>
          <div id="sh_appsettings" class="ml_row style_header">
            <div class="sl_text">App settings</div>
            <a class="sl_button ml_icon ml_icon_dots" onclick="expand_section('appsettings')"></a>
          </div>
          <div id="sg_appsettings" class="style_group">
            <div class="mi_range">
              <label for="at_scale">Song and Bible text size (scale by):</label>
              <input
                id="at_scale"
                type="range"
                min="1"
                max="3"
                step="0.1"
                oninput="style_slider_input(this)"
                onchange="style_slider_change(this)"
              />
              <output id="at_scale_out"></output>
            </div>
          </div>
          <div id="sh_recyclebin" class="ml_row style_header">
            <div class="sl_text">Song Recycle Bin</div>
            <a class="sl_button ml_icon ml_icon_dots" onclick="expand_section('recyclebin')"></a>
          </div>
          <div id="sg_recyclebin" class="style_group">
            <div id="recycle_bin" class="ml_list"></div>
            <button onclick="confirm_empty_recycle_bin()" class="cmd_button full_button">
              <img src="/html/icons/icons8-remove-24.png" />
              Empty Song Recycle Bin
            </button>
          </div>
          <h4>About Malachi</h4>
          <p>
            Malachi is open-source software, released under a
            <a href="https://www.gnu.org/licenses/gpl-3.0-standalone.html" target="_blank"
              >GPL3 license</a
            >.
          </p>
          <p>
            Some icons in Malachi are provided by
            <a href="https://icons8.com" target="_blank">Icons8</a>.
          </p>
        </div>

        <div id="updater_element" class="element_panel">
          <h3>Update Malachi</h3>
          <p>A new version of Malachi has been released - here's how to install it:</p>
          <ol id="update_instructions">
            <li>Save the service (if you want to load it later).</li>
            <li>
              Click the
              <strong>Update Malachi</strong>
              button below.
            </li>
            <li>
              Wait for the green
              <em>Connected to Malachi server</em>
              message to be displayed in the bottom left of the app.
            </li>
            <li>
              Press <strong>Ctrl + F5</strong> to refresh the app. Any other devices connected to
              Malachi will automatically reconnect to the server after a few seconds.
            </li>
          </ol>
          <button id="updater_btn" onclick="update_malachi()" class="cmd_button full_button">
            <img src="/html/icons/icons8-windows-update-24.png" />
            Update Malachi
          </button>
        </div>
      </div>
    </div>

    <!-- POPUP: Prompt to save before stating new service -->
    <div id="popup_new_service" class="popup_wrapper">
      <div class="popup_v_spacer"></div>
      <div style="display: flex">
        <div class="popup_h_spacer"></div>
        <div style="display: flex; flex-direction: column">
          <div class="popup_header">
            <span>Save service?</span>
          </div>
          <div class="popup_panel">
            <p>
              The current service has been modified.<br />Save these changes before starting a new
              service?
            </p>
            <div class="popup_buttons">
              <div class="cmd_button menu_button dialog_button" onclick="save_service('new')">
                Save
              </div>
              <div class="cmd_button menu_button dialog_button" onclick="new_service(true)">
                Discard
              </div>
              <div
                class="cmd_button menu_button dialog_button"
                onclick="close_popup('popup_new_service')"
              >
                Cancel
              </div>
            </div>
          </div>
        </div>
        <div class="popup_h_spacer"></div>
      </div>
      <div class="popup_v_spacer"></div>
    </div>

    <!-- POPUP: Prompt to save before loading service -->
    <div id="popup_save_before_load_service" class="popup_wrapper">
      <div class="popup_v_spacer"></div>
      <div style="display: flex">
        <div class="popup_h_spacer"></div>
        <div style="display: flex; flex-direction: column">
          <div class="popup_header">
            <span>Save service?</span>
          </div>
          <div class="popup_panel">
            <p>
              The current service has been modified.<br />Save these changes before loading a new
              service?
            </p>
            <div class="popup_buttons">
              <div class="cmd_button menu_button dialog_button" onclick="save_service('load')">
                Save
              </div>
              <div class="cmd_button menu_button dialog_button" onclick="load_service(true)">
                Discard
              </div>
              <div
                class="cmd_button menu_button dialog_button"
                onclick="close_popup('popup_save_before_load_service')"
              >
                Cancel
              </div>
            </div>
          </div>
        </div>
        <div class="popup_h_spacer"></div>
      </div>
      <div class="popup_v_spacer"></div>
    </div>

    <!-- POPUP: Save service as dialog -->
    <div id="popup_save_service_as" class="popup_wrapper">
      <div class="popup_v_spacer"></div>
      <div style="display: flex">
        <div class="popup_h_spacer"></div>
        <div style="display: flex; flex-direction: column">
          <div class="popup_header">
            <span>Save service as...</span>
          </div>
          <div class="popup_panel">
            <p>Choose filename to save service as:</p>
            <input
              id="f_name"
              name="f_name"
              type="text"
              value=""
              class="mi_textinput"
              placeholder="service.json"
            />
            <div class="popup_buttons">
              <div class="cmd_button menu_button dialog_button" onclick="save_service_as()">
                Save
              </div>
              <div class="cmd_button menu_button dialog_button" onclick="close_save_as_popup()">
                Cancel
              </div>
            </div>
          </div>
        </div>
        <div class="popup_h_spacer"></div>
      </div>
      <div class="popup_v_spacer"></div>
    </div>

    <!-- POPUP: Export service as dialog -->
    <div id="popup_export_service_as" class="popup_wrapper">
      <div class="popup_v_spacer"></div>
      <div style="display: flex">
        <div class="popup_h_spacer"></div>
        <div style="display: flex; flex-direction: column">
          <div class="popup_header">
            <span>Export service as...</span>
          </div>
          <div class="popup_panel">
            <p>Choose filename to export service as:</p>
            <input
              id="exp_name"
              name="exp_name"
              type="text"
              value=""
              class="mi_textinput"
              placeholder="service.zip"
            />
            <div class="popup_buttons">
              <div class="cmd_button menu_button dialog_button" onclick="export_service_as()">
                Export
              </div>
              <div class="cmd_button menu_button dialog_button" onclick="close_export_as_popup()">
                Cancel
              </div>
            </div>
          </div>
        </div>
        <div class="popup_h_spacer"></div>
      </div>
      <div class="popup_v_spacer"></div>
    </div>

    <!-- POPUP: Load service dialog -->
    <div id="popup_load_service" class="popup_wrapper">
      <div class="popup_v_spacer"></div>
      <div style="display: flex">
        <div class="popup_h_spacer"></div>
        <div style="display: flex; flex-direction: column">
          <div class="popup_header">
            <span>Load service</span>
          </div>
          <div class="popup_panel">
            <p>Choose service to load:</p>
            <div
              id="load_files_radio"
              class="ml_list"
              style="max-height: 250px; overflow-y: auto; width: 100%"
            ></div>
            <div class="popup_buttons">
              <div class="cmd_button menu_button dialog_button" onclick="load_service(false)">
                Load
              </div>
              <div
                class="cmd_button menu_button dialog_button"
                onclick="close_popup('popup_load_service')"
              >
                Cancel
              </div>
            </div>
          </div>
        </div>
        <div class="popup_h_spacer"></div>
      </div>
      <div class="popup_v_spacer"></div>
    </div>

    <!-- POPUP: Attach audio dialog -->
    <div id="popup_attach_audio" class="popup_wrapper">
      <div class="popup_v_spacer"></div>
      <div style="display: flex">
        <div class="popup_h_spacer"></div>
        <div style="display: flex; flex-direction: column">
          <div class="popup_header">
            <span>Attach audio to song</span>
          </div>
          <div class="popup_panel">
            <p>Choose audio to attach:</p>
            <div
              id="attach_audio_radio"
              class="ml_list"
              style="max-height: 250px; overflow-y: auto; width: 100%"
            ></div>
            <div class="popup_buttons">
              <div class="cmd_button menu_button dialog_button" onclick="attach_audio()">
                Attach
              </div>
              <div
                class="cmd_button menu_button dialog_button"
                onclick="close_attach_audio_popup()"
              >
                Cancel
              </div>
            </div>
          </div>
        </div>
        <div class="popup_h_spacer"></div>
      </div>
      <div class="popup_v_spacer"></div>
    </div>

    <!-- POPUP: Prompt to confirm song deletion -->
    <div id="popup_confirm_delete_song" class="popup_wrapper">
      <div class="popup_v_spacer"></div>
      <div style="display: flex">
        <div class="popup_h_spacer"></div>
        <div style="display: flex; flex-direction: column">
          <div class="popup_header">
            <span>Delete song?</span>
          </div>
          <div class="popup_panel">
            <p>
              Are you sure that you want to delete the current song?<br />Deleted songs can be
              restored from the Song Recycle Bin in the Settings tab.
            </p>
            <div class="popup_buttons">
              <div class="cmd_button menu_button dialog_button" onclick="delete_song()">Delete</div>
              <div
                class="cmd_button menu_button dialog_button"
                onclick="close_popup('popup_confirm_delete_song')"
              >
                Cancel
              </div>
            </div>
          </div>
        </div>
        <div class="popup_h_spacer"></div>
      </div>
      <div class="popup_v_spacer"></div>
    </div>

    <!-- POPUP: Prompt to confirm emptying song recycle bin -->
    <div id="popup_confirm_empty_bin" class="popup_wrapper">
      <div class="popup_v_spacer"></div>
      <div style="display: flex">
        <div class="popup_h_spacer"></div>
        <div style="display: flex; flex-direction: column">
          <div class="popup_header">
            <span>Empty Song Recycle Bin?</span>
          </div>
          <div class="popup_panel">
            <p>
              Are you sure that you want to empty the Song Recycle Bin?<br />
              All Songs in the Recycle Bin will be deleted permanently.
            </p>
            <div class="popup_buttons">
              <div class="cmd_button menu_button dialog_button" onclick="empty_recycle_bin()">
                Empty Bin
              </div>
              <div
                class="cmd_button menu_button dialog_button"
                onclick="close_popup('popup_confirm_empty_bin')"
              >
                Cancel
              </div>
            </div>
          </div>
        </div>
        <div class="popup_h_spacer"></div>
      </div>
      <div class="popup_v_spacer"></div>
    </div>

    <!-- POPUP: Edit song dialog -->
    <div id="popup_edit_song" class="popup_wrapper">
      <div class="popup_v_spacer"></div>
      <div class="popup_header">
        <span id="popup_edit_mode">Edit song</span>
      </div>
      <div class="popup_h_content">
        <!-- Left column -->
        <div class="popup_panel">
          <span id="e_title_span">Song name:</span>
          <input type="text" id="e_title" class="mi_textinput" />
          <div class="popup_row">
            <div class="popup_column">
              <span>Author:</span>
              <input type="text" id="e_author" class="mi_textinput" />
            </div>
            <div id="e_remote_div" class="radio_toggle_group">
              <input type="radio" name="e_remote" id="e_remote_0" data-lr="0" />
              <label for="e_remote_0">Local</label>
              <input type="radio" name="e_remote" id="e_remote_1" data-lr="1" />
              <label for="e_remote_1">Remote</label>
            </div>
          </div>
          <span>Copyright:</span>
          <input type="text" id="e_copyright" class="mi_textinput" />
          <div class="popup_row">
            <div class="popup_column">
              <span>Song book:</span>
              <input type="text" id="e_book" class="mi_textinput" />
            </div>
            <div class="popup_column">
              <span>Song number:</span>
              <input type="text" id="e_number" class="mi_textinput" />
            </div>
            <div class="popup_column">
              <span>Audio:</span>
              <input type="text" id="e_audio" class="mi_textinput" readonly />
            </div>
            <div id="e_audio_button_div">
              <div class="cmd_button small_button" onclick="audio_popup_preload()">
                <img src="/html/icons/icons8-plus-24.png" />
              </div>
              <div class="cmd_button small_button" onclick="remove_audio()">
                <img src="/html/icons/icons8-minus-24.png" />
              </div>
            </div>
          </div>
          <div style="width: 100%">
            <span
              data-tooltip="You can insert a fill into the order in the same way as a verse,
just make sure to start it with a : (e.g. C1 :1 V2)."
              ><img src="/html/icons/icons8-help-48.png" class="help_icon" />
            </span>
            Verse order:
          </div>
          <input type="text" id="e_order" class="mi_textinput" />
          <div style="width: 100%; display: flex; flex-direction: row; gap: 1em">
            <div style="display: flex; flex-direction: column; gap: 0.5em">
              <span>Key:</span>
              <div id="e_key_div" class="radio_toggle_group">
                <input type="radio" name="e_key" id="e_key_1" data-ek="C" />
                <label for="e_key_1">C</label>
                <input type="radio" name="e_key" id="e_key_2" data-ek="Db" />
                <label for="e_key_2">Db</label>
                <input type="radio" name="e_key" id="e_key_3" data-ek="D" />
                <label for="e_key_3">D</label>
                <input type="radio" name="e_key" id="e_key_4" data-ek="Eb" />
                <label for="e_key_4">Eb</label>
                <input type="radio" name="e_key" id="e_key_5" data-ek="E" />
                <label for="e_key_5">E</label>
                <input type="radio" name="e_key" id="e_key_6" data-ek="F" />
                <label for="e_key_6">F</label>
                <input type="radio" name="e_key" id="e_key_7" data-ek="F#" />
                <label for="e_key_7">F#</label>
                <input type="radio" name="e_key" id="e_key_8" data-ek="G" />
                <label for="e_key_8">G</label>
                <input type="radio" name="e_key" id="e_key_9" data-ek="Ab" />
                <label for="e_key_9">Ab</label>
                <input type="radio" name="e_key" id="e_key_10" data-ek="A" />
                <label for="e_key_10">A</label>
                <input type="radio" name="e_key" id="e_key_11" data-ek="Bb" />
                <label for="e_key_11">Bb</label>
                <input type="radio" name="e_key" id="e_key_12" data-ek="B" />
                <label for="e_key_12">B</label>
              </div>
            </div>
            <div style="display: flex; flex-direction: column; gap: 0.5em">
              <span>Transpose by:</span>
              <div class="mi_range" style="margin-top: 0">
                <input id="e_transpose" type="range" min="0" max="11" step="1" />
                <output id="e_transpose_out"></output>
              </div>
            </div>
          </div>

          <div class="popup_baseline_row">
            <div
              id="delete_song_btn"
              class="cmd_button menu_button"
              onclick="confirm_delete_song()"
            >
              <img src="/html/icons/icons8-remove-24.png" />Delete song
            </div>
            <div class="popup_buttons">
              <div class="cmd_button menu_button dialog_button" onclick="save_song()">
                <img src="/html/icons/icons8-save-24.png" />Save
              </div>
              <div
                class="cmd_button menu_button dialog_button"
                onclick="close_popup('popup_edit_song')"
              >
                <img src="/html/icons/icons8-close-window-24.png" />
                Cancel
              </div>
            </div>
          </div>
        </div>
        <!-- Right column -->
        <div class="popup_panel">
          <div>
            <span
              data-tooltip="Use tags in angle brackets (e.g. &lt;V1&gt;) to indicate the start of sections.
Insert a mandatory line break by placing [br] on a line by itself.
Place chords on the line before their lyrics and finish chord lines with @.
Use # to pad out lyrics so that they line up with their chords."
              ><img src="/html/icons/icons8-help-48.png" class="help_icon" />
            </span>
            Lyrics and chords:
          </div>
          <textarea
            cols="48"
            rows="15"
            name="e_lyrics"
            id="e_lyrics"
            class="mi_textarea"
          ></textarea>
          <div style="width: 100%">
            <span
              data-tooltip="Place one fill (intro, outro etc) per line.
Only use chords, there is no need to end the line with an @."
              ><img src="/html/icons/icons8-help-48.png" class="help_icon" />
            </span>
            Fills:
          </div>
          <div id="fill_editor">
            <div id="line_numbers"></div>
            <textarea cols="50" rows="5" name="e_fills" id="e_fills" class="mi_textarea"></textarea>
          </div>
        </div>
      </div>
      <div class="popup_v_spacer"></div>
    </div>
    <div
      id="drag_ghost"
      class="ml_list"
      style="position: absolute; top: -200; left: 0; width: 275px"
    >
      <div class="ml_row">
        <div class="ml_text">
          <img
            id="drag_song_icon"
            class="ml_drag_icon"
            src="/html/icons/icons8-musical-notes-48.png"
          />
          <img
            id="drag_bible_icon"
            class="ml_drag_icon"
            src="/html/icons/icons8-literature-48.png"
          />
          <img
            id="drag_presentation_icon"
            class="ml_drag_icon"
            src="/html/icons/icons8-presentation-48.png"
          />
          <img id="drag_video_icon" class="ml_drag_icon" src="/html/icons/icons8-tv-show-48.png" />
          <span id="ghost_text">Song title goes here</span>
        </div>
      </div>
    </div>
  </body>
</html>
